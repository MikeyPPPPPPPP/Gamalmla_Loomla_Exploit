import argparse
import requests
from bs4 import BeautifulSoup

from spider import SPIDER


class Exploit:
    """
    @ Description
    `````````````
    This exploit spider a website and look for huge files
    containg the siginture.

    """
    def __init__(self, url: str):
        self.url: str = url
        self.spider = SPIDER(self.url)

    def run(self):
        self.spider.recursive_spider()

        if len(self.spider.vulnerable_page) > 0:
            for key, values in self.spider.leak_occurence_rate_log.items():
                print(key, values)
            return
        print("Not Vulunerable.")



def main(url):
    a = Exploit(url)
    a.run()



if __name__ == "__main__":
    ar = argparse.ArgumentParser()
    #basic
    basic = ar.add_argument_group('basic options')
    basic.add_argument('-u', '--url', help="The domain needs to be running droopla", required=True)
    args = ar.parse_args()

    main(args.url)
